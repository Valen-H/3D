"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function mod(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2],e=[n,r].sort(),a=_slicedToArray(e,2);n=a[0],r=a[1];var i=r-n;return n>t?t+i:t>r?t-i:t}function inherit(t,n){for(var r in n)t[r]=n[r];return t}var _createClass=function(){function t(t,n){for(var r=0;n.length>r;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,r,e){return r&&t(n.prototype,r),e&&t(n,e),n}}(),_slicedToArray=function(){function t(t,n){var r=[],e=!0,a=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(e=(s=o.next()).done)&&(r.push(s.value),!n||r.length!==n);e=!0);}catch(u){a=!0,i=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(a)throw i}}return r}return function(n,r){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P2=2*Math.PI,D3Map=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;_classCallCheck(this,t),this.surface=[0,0,n],this.camera=[0,0,n],this.orientation=[0,0,0],this.pointlist=[],this.Point=t.Point}return _createClass(t,[{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-this.orientation[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.orientation[0]=mod(this.orientation[0]+t,0,P2),this.orientation[1]=mod(this.orientation[1]+n,0,P2),this.orientation[2]=mod(this.orientation[2]+r,0,P2),this}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-this.camera[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.camera[0]+=t,this.camera[1]+=n,this.camera[2]+=r,this}},{key:"display",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return inherit(this.surface,[t,n,r]),this}},{key:"reset",value:function(){return this.orientation=[0,0,0],this.camera=[0,0,0],this}},{key:"add",value:function(){for(var t=this,n=arguments.length,r=Array(n),e=0;n>e;e++)r[e]=arguments[e];if(r.every(function(n){return n instanceof t.Point})){var a=!0,i=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var h=o.value;this.add(h.x,h.y,h.z)}}catch(c){i=!0,s=c}finally{try{!a&&u.return&&u.return()}finally{if(i)throw s}}return this}var m=new(Function.prototype.bind.apply(this.Point,[null].concat(r,[this])));return this.pointlist.push(m),m}}]),t}(),D3Point=function(){function t(n,r,e,a){_classCallCheck(this,t),this.x=n,this.y=r,this.z=e,this.map=a,this._id=this.map.Point.idcnt++}return _createClass(t,[{key:"coords",get:function(){var t=Math.cos(this.map.orientation[0]),n=Math.cos(this.map.orientation[1]),r=Math.cos(this.map.orientation[2]),e=Math.sin(this.map.orientation[0]),a=Math.sin(this.map.orientation[1]),i=Math.sin(this.map.orientation[2]),s=this.x-this.map.camera[0],o=this.y-this.map.camera[1],u=this.z-this.map.camera[2],h=i*o,c=i*s,m=r*s,l=r*o,g=a*u,f=n*u;return[n*(h+m)-g,e*(f+a*(h+m))+t*(l-c),t*(f+a*(h+m))-e*(l-c)]}},{key:"coord2d",get:function(){var t=this.coords,n=this.map.surface[2]/t[2];return[n*t[0]+this.map.surface[0],n*t[1]+this.map.surface[1]]}}]),t}();D3Point.idcnt=0,D3Map.Point=D3Point;